<h2><%= @event.name %></h2>

<table class="vertical_header">
  <tr>
    <th>Date</th>
    <td>
      <%= @event.date %>
    </td>
  </tr>
  
  <tr>
    <th>Deadline</th>
    <td><%= @event.deadline %></td>
  </tr>
  
  
  <tr>
    <th>Payment time</th>
    <td><%= @event.payment_time %> days</td>
  </tr>
  
</table>

<h3>Mail templates</h3>
<% if !@event.mail_templates.blank? %>
  <% for template in @event.mail_templates %>
    <h4><%= template.name.humanize %></h4>
    
    <table class="vertical_header">
      <tr>
        <th>Subject:</th>
        <td><%= template.subject %></td>
      </tr>
      
      <tr>
        <th>Body:</th>
        <td><%= template.body %></td>
      </tr>
    </table>
  <% end %>
<% else %>
  
<% end %>

<h3>Ticket types</h3>
<% if !@event.ticket_types.blank? %>
  <table class="vertical_header">
  <% for type in @event.ticket_types %>
    <tr>
      <th><%= type.name %></th>
      <td><%= type.price %> kr</td>
    </tr>
  <% end %>
  </table>
<% else %>
  
<% end %>

<h3>Guests</h3>

<table border="0" id="guest_list_table">
  <tr>
    <th>Name</th>
    <th>E-mail</th>
    <th>Ticket type</th>
    <th>State</th>
    <th>Food preferences</th>
    <th>Comments</th>
  </tr>
  <% @event.replies.each do |reply| %>
  <tr>
    <td><%= reply.name %></td>
    <td><%= reply.email %></td>
    <td><%= reply.ticket_type.name %></td>
    <td>
      <% if reply.aasm_current_state == :expired %>
        Expired (No payment)
      <% elsif reply.aasm_current_state == :paid %>
        Paid (<%= reply.paid_at.strftime("%Y-%m-%d") %>)
      <% elsif reply.aasm_current_state == :new %>
        Unpaid
      <% end -%>
    <td><%= reply.food %></td>
    <td><%= reply.comments %></td>
  </tr>
  
  <% end -%>
</table>